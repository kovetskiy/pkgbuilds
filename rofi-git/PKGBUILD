pkgname="rofi-git"
pkgver=${PKGVER:-autogenerated}
pkgrel=${PKGREL:-1}
pkgdesc="Window switcher, run dialog and dmenu replacement"
arch=('any')
license=("GPL")
depends=(
    "pkg-config"
    "xcb-proto"
    "xcb-util"
    "xcb-util-xrm"
)
source=(
    "$pkgname::git://github.com/DaveDavenport/rofi"
)
md5sums=("SKIP")

pkgver() {
    cd "$srcdir/$pkgname"
    local date=$(git log -1 --format="%cd" --date=short | sed s/-//g)
    local count=$(git rev-list --count HEAD)
    local commit=$(git rev-parse --short HEAD)
    echo "$date.${count}_$commit"
}

build() {
    cd "$srcdir/$pkgname"

    git submodule update --init

    autoreconf -i

    ./configure --prefix="$srcdir/usr"
    make
    make install
}

package() {
    cp -r "$srcdir/usr" "$pkgdir/"
}
